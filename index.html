<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“… çš®å¡ä¸˜çš„å¯’å‡æ‰“å¡æ—¥å† âš¡</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #FFE4E1 0%, #FFF8DC 50%, #E0FFFF 100%);
            min-height: 100vh;
            color: #333333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* å¤´éƒ¨æ ·å¼ */
        .header {
            background: linear-gradient(135deg, #FFD700, #FFB347);
            padding: 25px 35px;
            border-radius: 25px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: 'âš¡';
            position: absolute;
            font-size: 200px;
            opacity: 0.1;
            top: -50px;
            right: -30px;
            animation: float 3s ease-in-out infinite;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .pokemon-icon {
            font-size: 50px;
            animation: bounce 2s infinite;
        }

        .title-text {
            font-size: 32px;
            font-weight: 800;
            color: #333333;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .trainer-info {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 20px;
        }

        .trainer-avatar {
            font-size: 40px;
        }

        .trainer-stats {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .trainer-name {
            font-weight: 700;
            font-size: 16px;
            color: #333333;
        }

        .trainer-level {
            font-size: 14px;
            color: #666666;
            background: rgba(255, 215, 0, 0.5);
            padding: 2px 10px;
            border-radius: 10px;
            display: inline-block;
            width: fit-content;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #FFFFFF, #FFF8DC);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(180deg, #FFD700, #FFB347);
            border-radius: 20px 0 0 20px;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            font-size: 40px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .stat-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 800;
            color: #FFB347;
        }

        .stat-label {
            font-size: 14px;
            color: #666666;
            font-weight: 600;
        }

        /* æ—¥å†å®¹å™¨ */
        .calendar-container {
            background: linear-gradient(135deg, #FFFFFF, #FFF8DC);
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px solid #FFE4E1;
        }

        .calendar-title {
            font-size: 24px;
            font-weight: 700;
            color: #333333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calendar-navigation {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: linear-gradient(135deg, #FFD700, #FFB347);
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .nav-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        /* å‘¨æ¬¡é€‰æ‹©å™¨ */
        .week-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .week-tab {
            background: #FFFFFF;
            border: 3px solid #FFE4E1;
            padding: 12px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .week-tab:hover {
            border-color: #FFD700;
            transform: translateY(-2px);
        }

        .week-tab.active {
            background: linear-gradient(135deg, #FFD700, #FFB347);
            border-color: #FFD700;
            color: #333333;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
        }

        .week-progress {
            font-size: 12px;
            background: rgba(255, 255, 255, 0.5);
            padding: 2px 8px;
            border-radius: 10px;
        }

        /* æ—¥å†ç½‘æ ¼ */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
        }

        /* æ˜ŸæœŸæ ‡é¢˜ */
        .weekday-header {
            text-align: center;
            padding: 15px;
            font-weight: 700;
            color: #FFB347;
            font-size: 16px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 15px;
        }

        /* æ—¥å†æ—¥æœŸå¡ç‰‡ */
        .day-card {
            background: #FFFFFF;
            border-radius: 20px;
            padding: 15px;
            min-height: 200px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .day-card.completed {
            border-color: #95E1D3;
            background: linear-gradient(135deg, #FFFFFF, #E0FFF0);
        }

        .day-card.partial {
            border-color: #FFD700;
            background: linear-gradient(135deg, #FFFFFF, #FFF8E1);
        }

        .day-card.missed {
            border-color: #FFB6C1;
            background: linear-gradient(135deg, #FFFFFF, #FFE4E1);
            opacity: 0.7;
        }

        .day-card.today {
            border-color: #FFB347;
            box-shadow: 0 0 0 3px rgba(255, 179, 71, 0.3);
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px dashed #FFE4E1;
        }

        .day-number {
            font-size: 24px;
            font-weight: 800;
            color: #333333;
        }

        .day-date {
            font-size: 12px;
            color: #999999;
            font-weight: 600;
        }

        .day-pokemon {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 30px;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .day-card:hover .day-pokemon {
            transform: scale(1.2) rotate(10deg);
        }

        .day-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
            font-size: 12px;
            font-weight: 700;
            padding: 6px 12px;
            border-radius: 12px;
        }

        .day-status.completed {
            background: #95E1D3;
            color: #2D7A68;
        }

        .day-status.partial {
            background: #FFD700;
            color: #8B6914;
        }

        .day-status.pending {
            background: #FFE4E1;
            color: #B06B6B;
        }

        /* ä»»åŠ¡åˆ—è¡¨ */
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 10px;
            font-size: 11px;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            background: rgba(255, 215, 0, 0.1);
        }

        .task-icon {
            font-size: 14px;
        }

        .task-text {
            flex-grow: 1;
            color: #666666;
            line-height: 1.3;
        }

        .task-exp {
            font-size: 10px;
            font-weight: 700;
            color: #FFB347;
            background: rgba(255, 179, 71, 0.2);
            padding: 2px 6px;
            border-radius: 6px;
        }

        .task-item.done {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-item.done .task-icon {
            opacity: 0.6;
        }

        /* å®å¯æ¢¦å›¾é‰´ */
        .pokemon-collection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .pokemon-card {
            background: linear-gradient(135deg, #FFFFFF, #FFF8DC);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .pokemon-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .pokemon-card.unlocked {
            border: 3px solid #FFD700;
        }

        .pokemon-card.locked {
            opacity: 0.5;
            filter: grayscale(50%);
        }

        .pokemon-emoji {
            font-size: 40px;
            margin-bottom: 8px;
            display: block;
        }

        .pokemon-name {
            font-size: 12px;
            font-weight: 700;
            color: #333333;
            margin-bottom: 3px;
        }

        .pokemon-level {
            font-size: 10px;
            color: #666666;
            font-weight: 600;
        }

        .pokemon-card.locked::before {
            content: 'ğŸ”’';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 30px;
            z-index: 1;
        }

        /* å›¾ä¾‹ */
        .legend {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid;
        }

        .legend-color.completed {
            background: #E0FFF0;
            border-color: #95E1D3;
        }

        .legend-color.partial {
            background: #FFF8E1;
            border-color: #FFD700;
        }

        .legend-color.pending {
            background: #FFE4E1;
            border-color: #FFB6C1;
        }

        /* åŠ¨ç”» */
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .sparkle {
            animation: sparkle 1.5s ease-in-out infinite;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .calendar-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .header::before {
                display: none;
            }

            .trainer-info {
                flex-direction: column;
            }

            .calendar-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .day-card {
                min-height: 250px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .pokemon-collection {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }

        @media (max-width: 480px) {
            .title-text {
                font-size: 24px;
            }

            .calendar-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .week-selector {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <div class="header-title">
                <span class="pokemon-icon">âš¡</span>
                <div>
                    <div class="title-text">çš®å¡ä¸˜çš„å¯’å‡æ‰“å¡æ—¥å†</div>
                    <div style="font-size: 14px; color: #666666; margin-top: 5px;">2026å¹´2æœˆ2æ—¥ - 3æœˆ1æ—¥</div>
                </div>
            </div>
            <div class="header-actions">
                <div class="trainer-info">
                    <div class="trainer-avatar" id="trainerAvatar">ğŸ¾</div>
                    <div class="trainer-stats">
                        <div class="trainer-name" id="trainerName">è®­ç»ƒå¸ˆ</div>
                        <div class="trainer-level" id="trainerLevel">LV.1 çš®å¡ä¸˜</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-icon">ğŸ“…</span>
                <div class="stat-info">
                    <div class="stat-value" id="totalDays">28</div>
                    <div class="stat-label">æ€»å¤©æ•°</div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">âœ…</span>
                <div class="stat-info">
                    <div class="stat-value" id="completedDays">0</div>
                    <div class="stat-label">å®Œæˆå¤©æ•°</div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">ğŸ’</span>
                <div class="stat-info">
                    <div class="stat-value" id="totalExp">0</div>
                    <div class="stat-label">æ€»ç»éªŒå€¼</div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">ğŸ†</span>
                <div class="stat-info">
                    <div class="stat-value" id="completionRate">0%</div>
                    <div class="stat-label">å®Œæˆç‡</div>
                </div>
            </div>
        </div>

        <!-- å›¾ä¾‹ -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color completed"></div>
                <span>å…¨éƒ¨å®Œæˆ</span>
            </div>
            <div class="legend-item">
                <div class="legend-color partial"></div>
                <span>éƒ¨åˆ†å®Œæˆ</span>
            </div>
            <div class="legend-item">
                <div class="legend-color pending"></div>
                <span>å¾…å®Œæˆ</span>
            </div>
        </div>

        <!-- å‘¨æ¬¡é€‰æ‹©å™¨ -->
        <div class="week-selector" id="weekSelector">
            <!-- åŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- æ—¥å† -->
        <div class="calendar-container">
            <div class="calendar-header">
                <div class="calendar-title" id="calendarTitle">ğŸ“… ç¬¬ä¸€å‘¨ï¼šå¯åŠ¨é€‚åº”å‘¨ (2.2-2.8)</div>
                <div class="calendar-navigation">
                    <button class="nav-btn" onclick="previousWeek()">â¬…ï¸ ä¸Šä¸€å‘¨</button>
                    <button class="nav-btn" onclick="nextWeek()">ä¸‹ä¸€å‘¨ â¡ï¸</button>
                </div>
            </div>

            <div class="calendar-grid" id="calendarGrid">
                <!-- æ˜ŸæœŸæ ‡é¢˜ -->
                <div class="weekday-header">å‘¨ä¸€</div>
                <div class="weekday-header">å‘¨äºŒ</div>
                <div class="weekday-header">å‘¨ä¸‰</div>
                <div class="weekday-header">å‘¨å››</div>
                <div class="weekday-header">å‘¨äº”</div>
                <div class="weekday-header">å‘¨å…­</div>
                <div class="weekday-header">å‘¨æ—¥</div>
                <!-- åŠ¨æ€ç”Ÿæˆæ—¥æœŸå¡ç‰‡ -->
            </div>
        </div>

        <!-- å®å¯æ¢¦æ”¶é›† -->
        <div style="margin-top: 40px;">
            <h2 style="font-size: 24px; font-weight: 700; color: #333333; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                ğŸ® æˆ‘çš„å®å¯æ¢¦æ”¶è—
            </h2>
            <div class="pokemon-collection" id="pokemonCollection">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- é¡µè„š -->
        <footer style="text-align: center; padding: 30px; color: #666666; margin-top: 40px;">
            <p style="font-size: 18px; margin-bottom: 10px;">ğŸ’¡ çš®å¡ä¸˜çš„æ¸©é¦¨æç¤ºï¼šæ¯å¤©åšæŒæ‰“å¡ï¼Œæ”¶é›†æ›´å¤šå®å¯æ¢¦ï¼</p>
            <p style="font-size: 14px;">æœ€åæ›´æ–°ï¼š<span id="lastUpdate">-</span></p>
        </footer>
    </div>

    <script>
        // ==================== æ•°æ®æ¨¡å‹ ====================
        const WEEK_DATA = {
            1: {
                name: 'å¯åŠ¨é€‚åº”å‘¨',
                dateRange: '2.2-2.8',
                startDate: new Date('2026-02-02'),
                pokemon: 'âš¡',
                tasks: [
                    { time: '08:00-09:00', task: 'æ™¨è¯»30åˆ†é’Ÿ', exp: 10, icon: 'ğŸ“š' },
                    { time: '10:00-11:00', task: 'æ•°å­¦è®¡ç®—ç»ƒä¹ ', exp: 15, icon: 'ğŸ”¢' },
                    { time: '14:00-15:00', task: 'æˆ·å¤–è¿åŠ¨', exp: 10, icon: 'ğŸƒ' },
                    { time: '16:00-17:00', task: 'ç§‘å­¦å°å®éªŒ', exp: 15, icon: 'ğŸ”¬' },
                    { time: '19:00-20:00', task: 'äº²å­é˜…è¯»', exp: 10, icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦' }
                ]
            },
            2: {
                name: 'æ˜¥èŠ‚é¢„çƒ­å‘¨',
                dateRange: '2.9-2.15',
                startDate: new Date('2026-02-09'),
                pokemon: 'ğŸ‰',
                tasks: [
                    { time: '08:00-09:00', task: 'æ˜¥èŠ‚ä¹ ä¿—å­¦ä¹ ', exp: 10, icon: 'ğŸ§§' },
                    { time: '10:00-11:00', task: 'å†™æ˜¥è”', exp: 15, icon: 'âœï¸' },
                    { time: '14:00-15:00', task: 'åŒ…é¥ºå­', exp: 10, icon: 'ğŸ¥Ÿ' },
                    { time: '16:00-17:00', task: 'æ˜¥èŠ‚æ‰‹å·¥', exp: 15, icon: 'ğŸ¨' },
                    { time: '19:00-20:00', task: 'å®¶åº­æ´»åŠ¨', exp: 10, icon: 'ğŸ‰' }
                ]
            },
            3: {
                name: 'æ·±åº¦å­¦ä¹ å‘¨',
                dateRange: '2.16-2.22',
                startDate: new Date('2026-02-16'),
                pokemon: 'ğŸ¦…',
                tasks: [
                    { time: 'ä¸Šåˆ', task: 'æ·±åº¦é˜…è¯»1å°æ—¶', exp: 20, icon: 'ğŸ“–' },
                    { time: 'ä¸‹åˆ', task: 'ä¸“é¢˜è®­ç»ƒ', exp: 25, icon: 'ğŸ“' },
                    { time: 'æ™šä¸Š', task: 'ç»¼åˆç»ƒä¹ ', exp: 20, icon: 'ğŸ’¡' }
                ]
            },
            4: {
                name: 'å†²åˆºæ”¶å°¾å‘¨',
                dateRange: '2.23-3.1',
                startDate: new Date('2026-02-23'),
                pokemon: 'ğŸŒŸ',
                tasks: [
                    { time: '08:00-09:00', task: 'æ™¨è¯»30åˆ†é’Ÿ', exp: 10, icon: 'ğŸ“š' },
                    { time: '10:00-11:00', task: 'ç»¼åˆå¤ä¹ ', exp: 15, icon: 'ğŸ”„' },
                    { time: '14:00-15:00', task: 'ä½“è‚²è®­ç»ƒ', exp: 10, icon: 'ğŸ†' },
                    { time: '16:00-17:00', task: 'é¡¹ç›®æ€»ç»“', exp: 15, icon: 'ğŸ“‹' },
                    { time: '19:00-20:00', task: 'å®¶åº­æ—¶å…‰', exp: 10, icon: 'â¤ï¸' }
                ]
            }
        };

        const POKEMON_COLLECTION = [
            { id: 1, emoji: 'âš¡', name: 'çš®å¡ä¸˜', level: 'LV.1-5', unlocked: false },
            { id: 2, emoji: 'ğŸ­', name: 'å°æ‹‰è¾¾', level: 'LV.1-5', unlocked: false },
            { id: 3, emoji: 'ğŸ¦', name: 'æ³¢æ³¢', level: 'LV.1-5', unlocked: false },
            { id: 4, emoji: 'ğŸ›', name: 'ç»¿æ¯›è™«', level: 'LV.1-5', unlocked: false },
            { id: 5, emoji: 'ğŸ”¥', name: 'å°ç«é¾™', level: 'LV.6-10', unlocked: false },
            { id: 6, emoji: 'ğŸ’§', name: 'æ°å°¼é¾Ÿ', level: 'LV.6-10', unlocked: false },
            { id: 7, emoji: 'ğŸƒ', name: 'å¦™è›™ç§å­', level: 'LV.6-10', unlocked: false },
            { id: 8, emoji: 'ğŸŒ™', name: 'çš®çš®', level: 'LV.6-10', unlocked: false },
            { id: 9, emoji: 'âš¡', name: 'é›·ä¸˜', level: 'LV.11-15', unlocked: false },
            { id: 10, emoji: 'ğŸ”¥', name: 'ç«æé¾™', level: 'LV.11-15', unlocked: false },
            { id: 11, emoji: 'ğŸ’§', name: 'æ°´ç®­é¾Ÿ', level: 'LV.11-15', unlocked: false },
            { id: 12, emoji: 'ğŸƒ', name: 'å¦™è›™èŠ±', level: 'LV.11-15', unlocked: false },
            { id: 13, emoji: 'ğŸ¦…', name: 'é—ªç”µé¸Ÿ', level: 'LV.16-20', unlocked: false },
            { id: 14, emoji: 'ğŸ”¥', name: 'å–·ç«é¾™', level: 'LV.16-20', unlocked: false },
            { id: 15, emoji: 'ğŸ’', name: 'æ°´ç®­é¾Ÿ', level: 'LV.16-20', unlocked: false },
            { id: 16, emoji: 'ğŸŒ¸', name: 'æ¢¦å¹»', level: 'LV.21+', unlocked: false },
            { id: 17, emoji: 'ğŸ”®', name: 'è¶…æ¢¦', level: 'LV.21+', unlocked: false },
            { id: 18, emoji: 'ğŸŒˆ', name: 'ä¸ƒå½©æ¢¦å¹»', level: 'LV.21+', unlocked: false },
            { id: 19, emoji: 'â­', name: 'é˜¿å°”å®™æ–¯', level: 'LV.21+', unlocked: false },
            { id: 20, emoji: 'ğŸŒŸ', name: 'è£‚ç©ºåº§', level: 'LV.21+', unlocked: false }
        ];

        // æ•°æ®å­˜å‚¨
        let calendarData = JSON.parse(localStorage.getItem('calendarData')) || {
            currentWeek: 1,
            trainerName: '',
            totalExp: 0,
            completedDays: 0,
            dayData: {}
        };

        // å½“å‰æ˜¾ç¤ºçš„å‘¨æ¬¡
        let currentDisplayWeek = 1;

        // ==================== åˆå§‹åŒ– ====================
        function init() {
            renderWeekSelector();
            renderCalendar();
            renderPokemonCollection();
            updateStats();
            loadFromMainApp();
        }

        // ä»ä¸»åº”ç”¨åŠ è½½æ•°æ®
        function loadFromMainApp() {
            const mainData = localStorage.getItem('pokemonData');
            if (mainData) {
                const data = JSON.parse(mainData);
                calendarData.trainerName = data.trainer.name;
                calendarData.totalExp = data.trainer.total_exp;
                
                // ç»Ÿè®¡å®Œæˆå¤©æ•°
                let completedDays = 0;
                Object.values(data.weeks).forEach(week => {
                    completedDays += week.completed_days;
                });
                calendarData.completedDays = completedDays;

                // è§£é”å®å¯æ¢¦
                const level = Math.floor(data.trainer.total_exp / 100) + 1;
                POKEMON_COLLECTION.forEach(pokemon => {
                    const pokemonLevel = parseInt(pokemon.level.replace('LV.', '').split('-')[0]);
                    pokemon.unlocked = level >= pokemonLevel;
                });

                saveData();
            }
        }

        function saveData() {
            localStorage.setItem('calendarData', JSON.stringify(calendarData));
            updateStats();
            renderPokemonCollection();
        }

        // ==================== æ¸²æŸ“å‡½æ•° ====================
        function renderWeekSelector() {
            const container = document.getElementById('weekSelector');
            container.innerHTML = '';

            for (let week = 1; week <= 4; week++) {
                const weekInfo = WEEK_DATA[week];
                const tab = document.createElement('div');
                tab.className = `week-tab ${week === currentDisplayWeek ? 'active' : ''}`;
                tab.innerHTML = `
                    <span style="font-size: 20px;">${weekInfo.pokemon}</span>
                    <span>ç¬¬${week}å‘¨</span>
                    <span class="week-progress">${weekInfo.name}</span>
                `;
                tab.onclick = () => showWeek(week);
                container.appendChild(tab);
            }
        }

        function renderCalendar() {
            const weekInfo = WEEK_DATA[currentDisplayWeek];
            const grid = document.getElementById('calendarGrid');
            const title = document.getElementById('calendarTitle');

            // æ›´æ–°æ ‡é¢˜
            title.innerHTML = `ğŸ“… ç¬¬${currentDisplayWeek}å‘¨ï¼š${weekInfo.name} (${weekInfo.dateRange})`;

            // ä¿ç•™æ˜ŸæœŸæ ‡é¢˜ï¼Œæ¸…é™¤æ—¥æœŸå¡ç‰‡
            const weekdayHeaders = grid.querySelectorAll('.weekday-header');
            grid.innerHTML = '';
            weekdayHeaders.forEach(header => grid.appendChild(header));

            // è·å–è¯¥å‘¨çš„å¼€å§‹æ—¥æœŸ
            const startDate = weekInfo.startDate;

            // ç”Ÿæˆ7å¤©çš„å¡ç‰‡
            for (let i = 0; i < 7; i++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + i);

                const dateKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
                const dayData = calendarData.dayData[dateKey] || { tasks: {} };

                const allCompleted = weekInfo.tasks.every(task => dayData.tasks[task.time]?.completed);
                const anyCompleted = weekInfo.tasks.some(task => dayData.tasks[task.time]?.completed);

                let statusClass = 'pending';
                let statusText = 'å¾…å®Œæˆ';
                if (allCompleted) {
                    statusClass = 'completed';
                    statusText = 'âœ“ å…¨éƒ¨å®Œæˆ';
                } else if (anyCompleted) {
                    statusClass = 'partial';
                    statusText = 'â­• éƒ¨åˆ†å®Œæˆ';
                }

                const card = document.createElement('div');
                card.className = `day-card ${statusClass}`;
                card.innerHTML = `
                    <div class="day-pokemon">${weekInfo.pokemon}</div>
                    <div class="day-header">
                        <div>
                            <div class="day-number">${i + 1}</div>
                            <div class="day-date">${dateKey}</div>
                        </div>
                        <div class="day-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="task-list">
                        ${weekInfo.tasks.map(task => {
                            const taskData = dayData.tasks[task.time] || { completed: false };
                            return `
                                <div class="task-item ${taskData.completed ? 'done' : ''}" 
                                     onclick="toggleTask('${dateKey}', '${task.time}', ${task.exp})">
                                    <span class="task-icon">${taskData.completed ? 'âœ…' : 'â­•'}</span>
                                    <span class="task-text">${task.task}</span>
                                    <span class="task-exp">+${task.exp} EXP</span>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                grid.appendChild(card);
            }
        }

        function renderPokemonCollection() {
            const container = document.getElementById('pokemonCollection');
            container.innerHTML = '';

            POKEMON_COLLECTION.forEach(pokemon => {
                const card = document.createElement('div');
                card.className = `pokemon-card ${pokemon.unlocked ? 'unlocked' : 'locked'}`;
                card.innerHTML = `
                    <span class="pokemon-emoji">${pokemon.unlocked ? pokemon.emoji : 'â“'}</span>
                    <div class="pokemon-name">${pokemon.unlocked ? pokemon.name : '???'}</div>
                    <div class="pokemon-level">${pokemon.level}</div>
                `;
                container.appendChild(card);
            });
        }

        function updateStats() {
            document.getElementById('trainerName').textContent = calendarData.trainerName || 'è®­ç»ƒå¸ˆ';
            
            const level = Math.floor(calendarData.totalExp / 100) + 1;
            const pokemon = getLevelPokemon(level);
            document.getElementById('trainerLevel').textContent = `LV.${level} ${pokemon}`;

            document.getElementById('completedDays').textContent = calendarData.completedDays;
            document.getElementById('totalExp').textContent = calendarData.totalExp;

            const completionRate = Math.round((calendarData.completedDays / 28) * 100);
            document.getElementById('completionRate').textContent = `${completionRate}%`;

            document.getElementById('lastUpdate').textContent = new Date().toLocaleString('zh-CN');
        }

        function getLevelPokemon(level) {
            if (level <= 5) return 'çš®å¡ä¸˜';
            if (level <= 10) return 'é›·ä¸˜';
            if (level <= 15) return 'é›·ç²¾çµ';
            if (level <= 20) return 'é—ªç”µé¸Ÿ';
            return 'è¶…æ¢¦';
        }

        // ==================== äº¤äº’å‡½æ•° ====================
        function showWeek(week) {
            currentDisplayWeek = week;
            renderWeekSelector();
            renderCalendar();
        }

        function previousWeek() {
            if (currentDisplayWeek > 1) {
                showWeek(currentDisplayWeek - 1);
            }
        }

        function nextWeek() {
            if (currentDisplayWeek < 4) {
                showWeek(currentDisplayWeek + 1);
            }
        }

        function toggleTask(dateKey, taskTime, exp) {
            if (!calendarData.dayData[dateKey]) {
                calendarData.dayData[dateKey] = { tasks: {} };
            }

            const task = calendarData.dayData[dateKey].tasks[taskTime];
            if (!task) {
                calendarData.dayData[dateKey].tasks[taskTime] = { completed: false };
            }

            const currentStatus = calendarData.dayData[dateKey].tasks[taskTime].completed;

            if (!currentStatus) {
                // å®Œæˆä»»åŠ¡
                calendarData.dayData[dateKey].tasks[taskTime].completed = true;
                calendarData.totalExp += exp;
                
                // æ£€æŸ¥æ˜¯å¦è¯¥å¤©å…¨éƒ¨å®Œæˆ
                const weekInfo = WEEK_DATA[currentDisplayWeek];
                const allCompleted = weekInfo.tasks.every(task => 
                    calendarData.dayData[dateKey].tasks[task.time]?.completed
                );

                if (allCompleted) {
                    calendarData.completedDays++;
                }

                showNotification(`ä»»åŠ¡å®Œæˆï¼è·å¾— ${exp} EXPï¼ğŸ’`, 'success');
            } else {
                // å–æ¶ˆå®Œæˆ
                calendarData.dayData[dateKey].tasks[taskTime].completed = false;
                calendarData.totalExp -= exp;

                // æ£€æŸ¥æ˜¯å¦ä»å…¨éƒ¨å®Œæˆå˜ä¸ºéƒ¨åˆ†å®Œæˆ
                const weekInfo = WEEK_DATA[currentDisplayWeek];
                const wasAllCompleted = weekInfo.tasks.every(task => 
                    calendarData.dayData[dateKey].tasks[task.time]?.completed
                );

                if (!wasAllCompleted) {
                    calendarData.completedDays--;
                }

                showNotification('ä»»åŠ¡å·²å–æ¶ˆ', 'info');
            }

            saveData();
            renderCalendar();
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#95E1D3' : '#FFB6C1'};
                color: ${type === 'success' ? '#2D7A68' : '#B06B6B'};
                padding: 15px 25px;
                border-radius: 15px;
                font-weight: 700;
                font-size: 16px;
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // æ·»åŠ åŠ¨ç”»æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }

            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
